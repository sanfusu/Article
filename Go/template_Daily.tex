% 需要 litemize 的统一样式
% 需要一个 BNF 的代码语法格式
\usepackage{textcomp, listings, xcolor-material, enumitem, tabularx,amsmath,multirow, latexsym, amssymb}
\usepackage[noend]{algpseudocode}
\usepackage{algorithm, algorithmicx}
\usepackage[hmargin=1.25in, vmargin=1in]{geometry}
%\usepackage[T1]{fontenc}
\usepackage{hyperref}
\hypersetup{
	colorlinks,% 
}
% TODO: golang 的语言规范移除单独成文件或包！
\lstdefinelanguage{golang} {
	morekeywords={
		break,default,func,interface,select,
		case,defer,go,map,struct,
		chan,else,goto,package,switch,
		const,fallthrough,if,range,type,
		continue,for,import,return,var,
	},	% 关键词
	morekeywords=[2] {
		bool,byte,complex64,complex128,error,float32,float64,
		int,int8,int16,int32,int64,rune,string,
		uint,uint8,uint16,uint32,uint64,uintptr,
	},	% 预声明类型
	morekeywords=[3] {
		true,false,iota,nil
	}, 	% 预声明常量，nil 这里视为常量
	morekeywords=[4] {
		append,cap,close,complex,copy,delete,imag,len,
		make,new,panic,print,println,real,recover
	}, % 预声明函数
	sensitive=true,
	morecomment=[l]{//},
	morecomment=[s]{/*}{*/},
	morestring=[b]',
	morestring=[b]",
	morestring=[b]`,
}
\lstdefinelanguage{EBNF} {
	morestring=[b]',
	morestring=[b]",
	morecomment=[s]{/*}{*/},
}

\lstset{
	basicstyle=\small \ttfamily,
	stringstyle= \color{MaterialRed},
	commentstyle=\itshape \color{MaterialBlueGrey},
	tabsize=4,
	upquote=true,
	showstringspaces=false,
	numbers=left,
	xleftmargin=1.2\parindent,
	xrightmargin=\parindent,
	framexleftmargin=\parindent,
%	texcl=true,
	flexiblecolumns=true,
	fontadjust=true,
	columns=fullflexible,
	breaklines=true,
	keepspaces=true,
	escapechar=@,
	frame=single,
	frameround=tttt,
	rulecolor=\color{MaterialBlueGrey},
}
\lstdefinestyle{golang}{
	language=golang,
	keywordstyle=\color{MaterialCyan},		% keywords
	keywordstyle=[2]{\color{MaterialTeal}}, 	% 预声明类型
	keywordstyle=[3]{\color{MaterialIndigo}}, % 预声明常量
	keywordstyle=[4]{\color{MaterialIndigo}}, % 预声明函数
}
\lstdefinestyle{EBNF}{
	language=EBNF,
	identifierstyle = \color{MaterialCyan},
}

\setlist{noitemsep}
\setlist[1]{
labelindent=\parindent,
leftmargin=*
}
\setlist[description]{font=\ttfamily}

%\newenvironment*{code}[1][golang]
%{\begin{lstlisting}[style=#1]}
%{\end{lstlisting}}
% \renewcommand{\ldots}{…}

\hypersetup{
	colorlinks=true,
	allcolors=MaterialCyan,
	anchorcolor=MaterialCyan,
	pdfauthor=sanfusu,
	pdfkeywords=golang,
}
\newcommand{\code}{\lstinline}
\newcommand{\gocode}{\lstinline[language=golang, style=golang]}
\newcommand{\hreftext}[1]{\textsuperscript{{\scriptsize\textrm{[\ref{#1}]}}}}
% TODO language 和 style 可能重复
% FIXME depreciated
\lstnewenvironment{golang}[1][left]{
\lstset{language=golang, style=golang, numbers=#1}
}{}

\lstnewenvironment{EBNF}[1][left]{
\lstset{language=EBNF, style=EBNF, numbers=#1}
}{}

\lstnewenvironment{goblock}[1][left]{
\lstset{language=golang, style=golang, numbers=#1}
}{}

\lstnewenvironment{EBNFblock}[1][left]{
\lstset{language=EBNF, style=EBNF, numbers=#1}
}{}